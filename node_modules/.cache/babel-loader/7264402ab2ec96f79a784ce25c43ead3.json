{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _nodentRuntime = require('nodent-runtime');\n\nvar _nodentRuntime2 = _interopRequireDefault(_nodentRuntime);\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nexports.default = LeafletControl;\n\nvar _lodash = require('lodash.debounce');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _searchElement = require('./searchElement');\n\nvar _searchElement2 = _interopRequireDefault(_searchElement);\n\nvar _resultList = require('./resultList');\n\nvar _resultList2 = _interopRequireDefault(_resultList);\n\nvar _domUtils = require('./domUtils');\n\nvar _constants = require('./constants');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar defaultOptions = function defaultOptions() {\n  return {\n    position: 'topleft',\n    style: 'button',\n    showMarker: true,\n    showPopup: false,\n    popupFormat: function popupFormat(_ref) {\n      var result = _ref.result;\n      return '' + result.label;\n    },\n    marker: {\n      icon: new L.Icon.Default(),\n      draggable: false\n    },\n    maxMarkers: 1,\n    retainZoomLevel: false,\n    animateZoom: true,\n    searchLabel: 'Enter address',\n    notFoundMessage: 'Sorry, that address could not be found.',\n    messageHideDelay: 3000,\n    zoomLevel: 18,\n    classNames: {\n      container: 'leaflet-bar leaflet-control leaflet-control-geosearch',\n      button: 'leaflet-bar-part leaflet-bar-part-single',\n      resetButton: 'reset',\n      msgbox: 'leaflet-bar message',\n      form: '',\n      input: ''\n    },\n    autoComplete: true,\n    autoCompleteDelay: 250,\n    autoClose: false,\n    keepResult: false\n  };\n};\n\nvar wasHandlerEnabled = {};\nvar mapHandlers = ['dragging', 'touchZoom', 'doubleClickZoom', 'scrollWheelZoom', 'boxZoom', 'keyboard'];\nvar Control = {\n  initialize: function initialize(options) {\n    var _this = this;\n\n    this.markers = new L.FeatureGroup();\n    this.handlersDisabled = false;\n    this.options = _extends({}, defaultOptions(), options);\n    var _options = this.options,\n        style = _options.style,\n        classNames = _options.classNames,\n        searchLabel = _options.searchLabel,\n        autoComplete = _options.autoComplete,\n        autoCompleteDelay = _options.autoCompleteDelay;\n\n    if (style !== 'button') {\n      this.options.classNames.container += ' ' + options.style;\n    }\n\n    this.searchElement = new _searchElement2.default(_extends({}, this.options, {\n      handleSubmit: function handleSubmit(query) {\n        return _this.onSubmit(query);\n      }\n    }));\n    var _searchElement$elemen = this.searchElement.elements,\n        container = _searchElement$elemen.container,\n        form = _searchElement$elemen.form,\n        input = _searchElement$elemen.input;\n    var button = (0, _domUtils.createElement)('a', classNames.button, container);\n    button.title = searchLabel;\n    button.href = '#';\n    button.addEventListener('click', function (e) {\n      _this.onClick(e);\n    }, false);\n    var resetButton = (0, _domUtils.createElement)('a', classNames.resetButton, form);\n    resetButton.innerHTML = 'X';\n    button.href = '#';\n    resetButton.addEventListener('click', function () {\n      _this.clearResults(null, true);\n    }, false);\n\n    if (autoComplete) {\n      this.resultList = new _resultList2.default({\n        handleClick: function handleClick(_ref2) {\n          var result = _ref2.result;\n          input.value = result.label;\n\n          _this.onSubmit({\n            query: result.label,\n            data: result\n          });\n        }\n      });\n      form.appendChild(this.resultList.elements.container);\n      input.addEventListener('keyup', (0, _lodash2.default)(function (e) {\n        return _this.autoSearch(e);\n      }, autoCompleteDelay), true);\n      input.addEventListener('keydown', function (e) {\n        return _this.selectResult(e);\n      }, true);\n      input.addEventListener('keydown', function (e) {\n        return _this.clearResults(e, true);\n      }, true);\n    }\n\n    form.addEventListener('mouseenter', function (e) {\n      return _this.disableHandlers(e);\n    }, true);\n    form.addEventListener('mouseleave', function (e) {\n      return _this.restoreHandlers(e);\n    }, true);\n    this.elements = {\n      button: button,\n      resetButton: resetButton\n    };\n  },\n  onAdd: function onAdd(map) {\n    var _options2 = this.options,\n        showMarker = _options2.showMarker,\n        style = _options2.style;\n    this.map = map;\n\n    if (showMarker) {\n      this.markers.addTo(map);\n    }\n\n    if (style === 'bar') {\n      var form = this.searchElement.elements.form;\n      var root = map.getContainer().querySelector('.leaflet-control-container');\n      var container = (0, _domUtils.createElement)('div', 'leaflet-control-geosearch bar');\n      container.appendChild(form);\n      root.appendChild(container);\n      this.elements.container = container;\n    }\n\n    return this.searchElement.elements.container;\n  },\n  onRemove: function onRemove() {\n    var container = this.elements.container;\n\n    if (container) {\n      container.remove();\n    }\n\n    return this;\n  },\n  onClick: function onClick(event) {\n    event.preventDefault();\n    var _searchElement$elemen2 = this.searchElement.elements,\n        container = _searchElement$elemen2.container,\n        input = _searchElement$elemen2.input;\n\n    if (container.classList.contains('active')) {\n      (0, _domUtils.removeClassName)(container, 'active');\n      this.clearResults();\n    } else {\n      (0, _domUtils.addClassName)(container, 'active');\n      input.focus();\n    }\n  },\n  disableHandlers: function disableHandlers(e) {\n    var _this2 = this;\n\n    var form = this.searchElement.elements.form;\n\n    if (this.handlersDisabled || e && e.target !== form) {\n      return;\n    }\n\n    this.handlersDisabled = true;\n    mapHandlers.forEach(function (handler) {\n      if (_this2.map[handler]) {\n        wasHandlerEnabled[handler] = _this2.map[handler].enabled();\n\n        _this2.map[handler].disable();\n      }\n    });\n  },\n  restoreHandlers: function restoreHandlers(e) {\n    var _this3 = this;\n\n    var form = this.searchElement.elements.form;\n\n    if (!this.handlersDisabled || e && e.target !== form) {\n      return;\n    }\n\n    this.handlersDisabled = false;\n    mapHandlers.forEach(function (handler) {\n      if (wasHandlerEnabled[handler]) {\n        _this3.map[handler].enable();\n      }\n    });\n  },\n  selectResult: function selectResult(event) {\n    if (![_constants.ENTER_KEY, _constants.ARROW_DOWN_KEY, _constants.ARROW_UP_KEY].includes(event.keyCode)) {\n      return;\n    }\n\n    event.preventDefault();\n    var input = this.searchElement.elements.input;\n    var list = this.resultList;\n\n    if (event.keyCode === _constants.ENTER_KEY) {\n      var _item = list.select(list.selected);\n\n      this.onSubmit({\n        query: input.value,\n        data: _item\n      });\n      return;\n    }\n\n    var max = list.count() - 1;\n\n    if (max < 0) {\n      return;\n    } // eslint-disable-next-line no-bitwise\n\n\n    var next = event.code === 'ArrowDown' ? ~~list.selected + 1 : ~~list.selected - 1; // eslint-disable-next-line no-nested-ternary\n\n    var idx = next < 0 ? max : next > max ? 0 : next;\n    var item = list.select(idx);\n    input.value = item.label;\n  },\n  clearResults: function clearResults(event) {\n    var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    if (event && event.keyCode !== _constants.ESCAPE_KEY) {\n      return;\n    }\n\n    var input = this.searchElement.elements.input;\n    var _options3 = this.options,\n        keepResult = _options3.keepResult,\n        autoComplete = _options3.autoComplete;\n\n    if (force || !keepResult) {\n      input.value = '';\n      this.markers.clearLayers();\n    }\n\n    if (autoComplete) {\n      this.resultList.clear();\n    }\n  },\n  autoSearch: function autoSearch(event) {\n    return new Promise(function ($return, $error) {\n      var query, provider, results;\n\n      if (_constants.SPECIAL_KEYS.includes(event.keyCode)) {\n        return $return();\n      }\n\n      query = event.target.value;\n      provider = this.options.provider;\n\n      if (query.length) {\n        return provider.search({\n          query: query\n        }).then(function ($await_2) {\n          results = $await_2;\n          this.resultList.render(results);\n          return $If_1.call(this);\n        }.$asyncbind(this, $error), $error);\n      } else {\n        this.resultList.clear();\n        return $If_1.call(this);\n      }\n\n      function $If_1() {\n        return $return();\n      }\n    }.$asyncbind(this));\n  },\n  onSubmit: function onSubmit(query) {\n    return new Promise(function ($return, $error) {\n      var provider, results;\n      provider = this.options.provider;\n      return provider.search(query).then(function ($await_3) {\n        results = $await_3;\n\n        if (results && results.length > 0) {\n          this.showResult(results[0], query);\n        }\n\n        return $return();\n      }.$asyncbind(this, $error), $error);\n    }.$asyncbind(this));\n  },\n  showResult: function showResult(result, _ref3) {\n    var query = _ref3.query;\n    var autoClose = this.options.autoClose;\n    var markers = Object.keys(this.markers._layers);\n\n    if (markers.length >= this.options.maxMarkers) {\n      this.markers.removeLayer(markers[0]);\n    }\n\n    var marker = this.addMarker(result, query);\n    this.centerMap(result);\n    this.map.fireEvent('geosearch/showlocation', {\n      location: result,\n      marker: marker\n    });\n\n    if (autoClose) {\n      this.closeResults();\n    }\n  },\n  closeResults: function closeResults() {\n    var container = this.searchElement.elements.container;\n\n    if (container.classList.contains('active')) {\n      (0, _domUtils.removeClassName)(container, 'active');\n    }\n\n    this.restoreHandlers();\n    this.clearResults();\n  },\n  addMarker: function addMarker(result, query) {\n    var _this4 = this;\n\n    var _options4 = this.options,\n        options = _options4.marker,\n        showPopup = _options4.showPopup,\n        popupFormat = _options4.popupFormat;\n    var marker = new L.Marker([result.y, result.x], options);\n    var popupLabel = result.label;\n\n    if (typeof popupFormat === 'function') {\n      popupLabel = popupFormat({\n        query: query,\n        result: result\n      });\n    }\n\n    marker.bindPopup(popupLabel);\n    this.markers.addLayer(marker);\n\n    if (showPopup) {\n      marker.openPopup();\n    }\n\n    if (options.draggable) {\n      marker.on('dragend', function (args) {\n        _this4.map.fireEvent('geosearch/marker/dragend', {\n          location: marker.getLatLng(),\n          event: args\n        });\n      });\n    }\n\n    return marker;\n  },\n  centerMap: function centerMap(result) {\n    var _options5 = this.options,\n        retainZoomLevel = _options5.retainZoomLevel,\n        animateZoom = _options5.animateZoom;\n    var resultBounds = new L.LatLngBounds(result.bounds);\n    var bounds = resultBounds.isValid() ? resultBounds : this.markers.getBounds();\n\n    if (!retainZoomLevel && resultBounds.isValid()) {\n      this.map.fitBounds(bounds, {\n        animate: animateZoom\n      });\n    } else {\n      this.map.setView(bounds.getCenter(), this.getZoom(), {\n        animate: animateZoom\n      });\n    }\n  },\n  getZoom: function getZoom() {\n    var _options6 = this.options,\n        retainZoomLevel = _options6.retainZoomLevel,\n        zoomLevel = _options6.zoomLevel;\n    return retainZoomLevel ? this.map.getZoom() : zoomLevel;\n  }\n};\n\nfunction LeafletControl() {\n  if (!L || !L.Control || !L.Control.extend) {\n    throw new Error('Leaflet must be loaded before instantiating the GeoSearch control');\n  }\n\n  var LControl = L.Control.extend(Control);\n\n  for (var _len = arguments.length, options = Array(_len), _key = 0; _key < _len; _key++) {\n    options[_key] = arguments[_key];\n  }\n\n  return new (Function.prototype.bind.apply(LControl, [null].concat(options)))();\n}","map":{"version":3,"sources":["/home/thomas/Map-interactive/node_modules/leaflet-geosearch/lib/leafletControl.js"],"names":["Object","defineProperty","exports","value","_nodentRuntime","require","_nodentRuntime2","_interopRequireDefault","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","default","LeafletControl","_lodash","_lodash2","_searchElement","_searchElement2","_resultList","_resultList2","_domUtils","_constants","obj","__esModule","defaultOptions","position","style","showMarker","showPopup","popupFormat","_ref","result","label","marker","icon","L","Icon","Default","draggable","maxMarkers","retainZoomLevel","animateZoom","searchLabel","notFoundMessage","messageHideDelay","zoomLevel","classNames","container","button","resetButton","msgbox","form","input","autoComplete","autoCompleteDelay","autoClose","keepResult","wasHandlerEnabled","mapHandlers","Control","initialize","options","_this","markers","FeatureGroup","handlersDisabled","_options","searchElement","handleSubmit","query","onSubmit","_searchElement$elemen","elements","createElement","title","href","addEventListener","e","onClick","innerHTML","clearResults","resultList","handleClick","_ref2","data","appendChild","autoSearch","selectResult","disableHandlers","restoreHandlers","onAdd","map","_options2","addTo","root","getContainer","querySelector","onRemove","remove","event","preventDefault","_searchElement$elemen2","classList","contains","removeClassName","addClassName","focus","_this2","forEach","handler","enabled","disable","_this3","enable","ENTER_KEY","ARROW_DOWN_KEY","ARROW_UP_KEY","includes","keyCode","list","_item","select","selected","max","count","next","code","idx","item","force","undefined","ESCAPE_KEY","_options3","clearLayers","clear","Promise","$return","$error","provider","results","SPECIAL_KEYS","search","then","$await_2","render","$If_1","$asyncbind","$await_3","showResult","_ref3","keys","_layers","removeLayer","addMarker","centerMap","fireEvent","location","closeResults","_this4","_options4","Marker","y","x","popupLabel","bindPopup","addLayer","openPopup","on","args","getLatLng","_options5","resultBounds","LatLngBounds","bounds","isValid","getBounds","fitBounds","animate","setView","getCenter","getZoom","_options6","extend","Error","LControl","_len","Array","_key","Function","bind","apply","concat"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _nodentRuntime = require('nodent-runtime');\n\nvar _nodentRuntime2 = _interopRequireDefault(_nodentRuntime);\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.default = LeafletControl;\n\nvar _lodash = require('lodash.debounce');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _searchElement = require('./searchElement');\n\nvar _searchElement2 = _interopRequireDefault(_searchElement);\n\nvar _resultList = require('./resultList');\n\nvar _resultList2 = _interopRequireDefault(_resultList);\n\nvar _domUtils = require('./domUtils');\n\nvar _constants = require('./constants');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar defaultOptions = function defaultOptions() {\n  return {\n    position: 'topleft',\n    style: 'button',\n    showMarker: true,\n    showPopup: false,\n    popupFormat: function popupFormat(_ref) {\n      var result = _ref.result;\n      return '' + result.label;\n    },\n    marker: {\n      icon: new L.Icon.Default(),\n      draggable: false\n    },\n    maxMarkers: 1,\n    retainZoomLevel: false,\n    animateZoom: true,\n    searchLabel: 'Enter address',\n    notFoundMessage: 'Sorry, that address could not be found.',\n    messageHideDelay: 3000,\n    zoomLevel: 18,\n    classNames: {\n      container: 'leaflet-bar leaflet-control leaflet-control-geosearch',\n      button: 'leaflet-bar-part leaflet-bar-part-single',\n      resetButton: 'reset',\n      msgbox: 'leaflet-bar message',\n      form: '',\n      input: ''\n    },\n    autoComplete: true,\n    autoCompleteDelay: 250,\n    autoClose: false,\n    keepResult: false\n  };\n};\n\nvar wasHandlerEnabled = {};\nvar mapHandlers = ['dragging', 'touchZoom', 'doubleClickZoom', 'scrollWheelZoom', 'boxZoom', 'keyboard'];\n\nvar Control = {\n  initialize: function initialize(options) {\n    var _this = this;\n\n    this.markers = new L.FeatureGroup();\n    this.handlersDisabled = false;\n\n    this.options = _extends({}, defaultOptions(), options);\n\n    var _options = this.options,\n        style = _options.style,\n        classNames = _options.classNames,\n        searchLabel = _options.searchLabel,\n        autoComplete = _options.autoComplete,\n        autoCompleteDelay = _options.autoCompleteDelay;\n\n    if (style !== 'button') {\n      this.options.classNames.container += ' ' + options.style;\n    }\n\n    this.searchElement = new _searchElement2.default(_extends({}, this.options, {\n      handleSubmit: function handleSubmit(query) {\n        return _this.onSubmit(query);\n      }\n    }));\n\n    var _searchElement$elemen = this.searchElement.elements,\n        container = _searchElement$elemen.container,\n        form = _searchElement$elemen.form,\n        input = _searchElement$elemen.input;\n\n\n    var button = (0, _domUtils.createElement)('a', classNames.button, container);\n    button.title = searchLabel;\n    button.href = '#';\n\n    button.addEventListener('click', function (e) {\n      _this.onClick(e);\n    }, false);\n\n    var resetButton = (0, _domUtils.createElement)('a', classNames.resetButton, form);\n    resetButton.innerHTML = 'X';\n    button.href = '#';\n    resetButton.addEventListener('click', function () {\n      _this.clearResults(null, true);\n    }, false);\n\n    if (autoComplete) {\n      this.resultList = new _resultList2.default({\n        handleClick: function handleClick(_ref2) {\n          var result = _ref2.result;\n\n          input.value = result.label;\n          _this.onSubmit({ query: result.label, data: result });\n        }\n      });\n\n      form.appendChild(this.resultList.elements.container);\n\n      input.addEventListener('keyup', (0, _lodash2.default)(function (e) {\n        return _this.autoSearch(e);\n      }, autoCompleteDelay), true);\n      input.addEventListener('keydown', function (e) {\n        return _this.selectResult(e);\n      }, true);\n      input.addEventListener('keydown', function (e) {\n        return _this.clearResults(e, true);\n      }, true);\n    }\n\n    form.addEventListener('mouseenter', function (e) {\n      return _this.disableHandlers(e);\n    }, true);\n    form.addEventListener('mouseleave', function (e) {\n      return _this.restoreHandlers(e);\n    }, true);\n\n    this.elements = { button: button, resetButton: resetButton };\n  },\n  onAdd: function onAdd(map) {\n    var _options2 = this.options,\n        showMarker = _options2.showMarker,\n        style = _options2.style;\n\n\n    this.map = map;\n    if (showMarker) {\n      this.markers.addTo(map);\n    }\n\n    if (style === 'bar') {\n      var form = this.searchElement.elements.form;\n\n      var root = map.getContainer().querySelector('.leaflet-control-container');\n\n      var container = (0, _domUtils.createElement)('div', 'leaflet-control-geosearch bar');\n      container.appendChild(form);\n      root.appendChild(container);\n      this.elements.container = container;\n    }\n\n    return this.searchElement.elements.container;\n  },\n  onRemove: function onRemove() {\n    var container = this.elements.container;\n\n    if (container) {\n      container.remove();\n    }\n\n    return this;\n  },\n  onClick: function onClick(event) {\n    event.preventDefault();\n\n    var _searchElement$elemen2 = this.searchElement.elements,\n        container = _searchElement$elemen2.container,\n        input = _searchElement$elemen2.input;\n\n\n    if (container.classList.contains('active')) {\n      (0, _domUtils.removeClassName)(container, 'active');\n      this.clearResults();\n    } else {\n      (0, _domUtils.addClassName)(container, 'active');\n      input.focus();\n    }\n  },\n  disableHandlers: function disableHandlers(e) {\n    var _this2 = this;\n\n    var form = this.searchElement.elements.form;\n\n\n    if (this.handlersDisabled || e && e.target !== form) {\n      return;\n    }\n\n    this.handlersDisabled = true;\n    mapHandlers.forEach(function (handler) {\n      if (_this2.map[handler]) {\n        wasHandlerEnabled[handler] = _this2.map[handler].enabled();\n        _this2.map[handler].disable();\n      }\n    });\n  },\n  restoreHandlers: function restoreHandlers(e) {\n    var _this3 = this;\n\n    var form = this.searchElement.elements.form;\n\n\n    if (!this.handlersDisabled || e && e.target !== form) {\n      return;\n    }\n\n    this.handlersDisabled = false;\n    mapHandlers.forEach(function (handler) {\n      if (wasHandlerEnabled[handler]) {\n        _this3.map[handler].enable();\n      }\n    });\n  },\n  selectResult: function selectResult(event) {\n    if (![_constants.ENTER_KEY, _constants.ARROW_DOWN_KEY, _constants.ARROW_UP_KEY].includes(event.keyCode)) {\n      return;\n    }\n\n    event.preventDefault();\n\n    var input = this.searchElement.elements.input;\n\n\n    var list = this.resultList;\n\n    if (event.keyCode === _constants.ENTER_KEY) {\n      var _item = list.select(list.selected);\n      this.onSubmit({ query: input.value, data: _item });\n      return;\n    }\n\n    var max = list.count() - 1;\n    if (max < 0) {\n      return;\n    }\n\n    // eslint-disable-next-line no-bitwise\n    var next = event.code === 'ArrowDown' ? ~~list.selected + 1 : ~~list.selected - 1;\n    // eslint-disable-next-line no-nested-ternary\n    var idx = next < 0 ? max : next > max ? 0 : next;\n\n    var item = list.select(idx);\n    input.value = item.label;\n  },\n  clearResults: function clearResults(event) {\n    var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    if (event && event.keyCode !== _constants.ESCAPE_KEY) {\n      return;\n    }\n\n    var input = this.searchElement.elements.input;\n    var _options3 = this.options,\n        keepResult = _options3.keepResult,\n        autoComplete = _options3.autoComplete;\n\n\n    if (force || !keepResult) {\n      input.value = '';\n      this.markers.clearLayers();\n    }\n\n    if (autoComplete) {\n      this.resultList.clear();\n    }\n  },\n  autoSearch: function autoSearch(event) {\n    return new Promise(function ($return, $error) {\n      var query, provider, results;\n\n      if (_constants.SPECIAL_KEYS.includes(event.keyCode)) {\n        return $return();\n      }\n\n      query = event.target.value;\n      provider = this.options.provider;\n\n\n      if (query.length) {\n        return provider.search({ query: query }).then(function ($await_2) {\n          results = $await_2;\n          this.resultList.render(results);\n          return $If_1.call(this);\n        }.$asyncbind(this, $error), $error);\n      } else {\n        this.resultList.clear();\n        return $If_1.call(this);\n      }\n\n      function $If_1() {\n        return $return();\n      }\n    }.$asyncbind(this));\n  },\n  onSubmit: function onSubmit(query) {\n    return new Promise(function ($return, $error) {\n      var provider, results;\n      provider = this.options.provider;\n      return provider.search(query).then(function ($await_3) {\n\n        results = $await_3;\n\n        if (results && results.length > 0) {\n          this.showResult(results[0], query);\n        }\n        return $return();\n      }.$asyncbind(this, $error), $error);\n    }.$asyncbind(this));\n  },\n  showResult: function showResult(result, _ref3) {\n    var query = _ref3.query;\n    var autoClose = this.options.autoClose;\n\n\n    var markers = Object.keys(this.markers._layers);\n    if (markers.length >= this.options.maxMarkers) {\n      this.markers.removeLayer(markers[0]);\n    }\n\n    var marker = this.addMarker(result, query);\n    this.centerMap(result);\n\n    this.map.fireEvent('geosearch/showlocation', {\n      location: result,\n      marker: marker\n    });\n\n    if (autoClose) {\n      this.closeResults();\n    }\n  },\n  closeResults: function closeResults() {\n    var container = this.searchElement.elements.container;\n\n\n    if (container.classList.contains('active')) {\n      (0, _domUtils.removeClassName)(container, 'active');\n    }\n\n    this.restoreHandlers();\n    this.clearResults();\n  },\n  addMarker: function addMarker(result, query) {\n    var _this4 = this;\n\n    var _options4 = this.options,\n        options = _options4.marker,\n        showPopup = _options4.showPopup,\n        popupFormat = _options4.popupFormat;\n\n    var marker = new L.Marker([result.y, result.x], options);\n    var popupLabel = result.label;\n\n    if (typeof popupFormat === 'function') {\n      popupLabel = popupFormat({ query: query, result: result });\n    }\n\n    marker.bindPopup(popupLabel);\n\n    this.markers.addLayer(marker);\n\n    if (showPopup) {\n      marker.openPopup();\n    }\n\n    if (options.draggable) {\n      marker.on('dragend', function (args) {\n        _this4.map.fireEvent('geosearch/marker/dragend', {\n          location: marker.getLatLng(),\n          event: args\n        });\n      });\n    }\n\n    return marker;\n  },\n  centerMap: function centerMap(result) {\n    var _options5 = this.options,\n        retainZoomLevel = _options5.retainZoomLevel,\n        animateZoom = _options5.animateZoom;\n\n\n    var resultBounds = new L.LatLngBounds(result.bounds);\n    var bounds = resultBounds.isValid() ? resultBounds : this.markers.getBounds();\n\n    if (!retainZoomLevel && resultBounds.isValid()) {\n      this.map.fitBounds(bounds, { animate: animateZoom });\n    } else {\n      this.map.setView(bounds.getCenter(), this.getZoom(), { animate: animateZoom });\n    }\n  },\n  getZoom: function getZoom() {\n    var _options6 = this.options,\n        retainZoomLevel = _options6.retainZoomLevel,\n        zoomLevel = _options6.zoomLevel;\n\n    return retainZoomLevel ? this.map.getZoom() : zoomLevel;\n  }\n};\n\nfunction LeafletControl() {\n  if (!L || !L.Control || !L.Control.extend) {\n    throw new Error('Leaflet must be loaded before instantiating the GeoSearch control');\n  }\n\n  var LControl = L.Control.extend(Control);\n\n  for (var _len = arguments.length, options = Array(_len), _key = 0; _key < _len; _key++) {\n    options[_key] = arguments[_key];\n  }\n\n  return new (Function.prototype.bind.apply(LControl, [null].concat(options)))();\n}"]},"metadata":{},"sourceType":"script"}