{"ast":null,"code":"module.exports = function () {\n  function isThenable(obj) {\n    return obj && obj instanceof Object && typeof obj.then === \"function\";\n  }\n\n  function resolution(p, r, how) {\n    try {\n      /* 2.2.7.1 */\n      var x = how ? how(r) : r;\n      if (p === x)\n        /* 2.3.1 */\n        return p.reject(new TypeError(\"Promise resolution loop\"));\n\n      if (isThenable(x)) {\n        /* 2.3.3 */\n        x.then(function (y) {\n          resolution(p, y);\n        }, function (e) {\n          p.reject(e);\n        });\n      } else {\n        p.resolve(x);\n      }\n    } catch (ex) {\n      /* 2.2.7.2 */\n      p.reject(ex);\n    }\n  }\n\n  function _unchained(v) {}\n\n  function thenChain(res, rej) {\n    this.resolve = res;\n    this.reject = rej;\n  }\n\n  function Chained() {}\n\n  ;\n  Chained.prototype = {\n    resolve: _unchained,\n    reject: _unchained,\n    then: thenChain\n  };\n\n  function then(res, rej) {\n    var chain = new Chained();\n\n    try {\n      this._resolver(function (value) {\n        return isThenable(value) ? value.then(res, rej) : resolution(chain, value, res);\n      }, function (ex) {\n        resolution(chain, ex, rej);\n      });\n    } catch (ex) {\n      resolution(chain, ex, rej);\n    }\n\n    return chain;\n  }\n\n  function Thenable(resolver) {\n    this._resolver = resolver;\n    this.then = then;\n  }\n\n  ;\n\n  Thenable.resolve = function (v) {\n    return Thenable.isThenable(v) ? v : {\n      then: function (resolve) {\n        return resolve(v);\n      }\n    };\n  };\n\n  Thenable.isThenable = isThenable;\n  return Thenable;\n};","map":{"version":3,"sources":["/home/thomas/Map-interactive/node_modules/nodent-runtime/thenableFactory.js"],"names":["module","exports","isThenable","obj","Object","then","resolution","p","r","how","x","reject","TypeError","y","e","resolve","ex","_unchained","v","thenChain","res","rej","Chained","prototype","chain","_resolver","value","Thenable","resolver"],"mappings":"AAAAA,MAAM,CAACC,OAAP,GAAiB,YAAW;AACxB,WAASC,UAAT,CAAoBC,GAApB,EAAyB;AACrB,WAAOA,GAAG,IAAKA,GAAG,YAAYC,MAAvB,IAAkC,OAAOD,GAAG,CAACE,IAAX,KAAkB,UAA3D;AACH;;AAED,WAASC,UAAT,CAAoBC,CAApB,EAAsBC,CAAtB,EAAwBC,GAAxB,EAA6B;AACzB,QAAI;AACA;AACA,UAAIC,CAAC,GAAGD,GAAG,GAAGA,GAAG,CAACD,CAAD,CAAN,GAAUA,CAArB;AAEA,UAAID,CAAC,KAAGG,CAAR;AAAW;AACP,eAAOH,CAAC,CAACI,MAAF,CAAS,IAAIC,SAAJ,CAAc,yBAAd,CAAT,CAAP;;AAEJ,UAAIV,UAAU,CAACQ,CAAD,CAAd,EAAmB;AACf;AACAA,QAAAA,CAAC,CAACL,IAAF,CAAO,UAASQ,CAAT,EAAW;AACdP,UAAAA,UAAU,CAACC,CAAD,EAAGM,CAAH,CAAV;AACH,SAFD,EAEE,UAASC,CAAT,EAAW;AACTP,UAAAA,CAAC,CAACI,MAAF,CAASG,CAAT;AACH,SAJD;AAKH,OAPD,MAOO;AACHP,QAAAA,CAAC,CAACQ,OAAF,CAAUL,CAAV;AACH;AACJ,KAjBD,CAiBE,OAAOM,EAAP,EAAW;AACT;AACAT,MAAAA,CAAC,CAACI,MAAF,CAASK,EAAT;AACH;AACJ;;AAED,WAASC,UAAT,CAAoBC,CAApB,EAAsB,CAAE;;AACxB,WAASC,SAAT,CAAmBC,GAAnB,EAAuBC,GAAvB,EAA2B;AACvB,SAAKN,OAAL,GAAeK,GAAf;AACA,SAAKT,MAAL,GAAcU,GAAd;AACH;;AAED,WAASC,OAAT,GAAmB,CAAE;;AAAA;AACrBA,EAAAA,OAAO,CAACC,SAAR,GAAoB;AAChBR,IAAAA,OAAO,EAACE,UADQ;AAEhBN,IAAAA,MAAM,EAACM,UAFS;AAGhBZ,IAAAA,IAAI,EAACc;AAHW,GAApB;;AAMA,WAASd,IAAT,CAAce,GAAd,EAAkBC,GAAlB,EAAsB;AAClB,QAAIG,KAAK,GAAG,IAAIF,OAAJ,EAAZ;;AACA,QAAI;AACA,WAAKG,SAAL,CAAe,UAASC,KAAT,EAAgB;AAC3B,eAAOxB,UAAU,CAACwB,KAAD,CAAV,GAAoBA,KAAK,CAACrB,IAAN,CAAWe,GAAX,EAAeC,GAAf,CAApB,GAA0Cf,UAAU,CAACkB,KAAD,EAAOE,KAAP,EAAaN,GAAb,CAA3D;AACH,OAFD,EAEE,UAASJ,EAAT,EAAa;AACXV,QAAAA,UAAU,CAACkB,KAAD,EAAOR,EAAP,EAAUK,GAAV,CAAV;AACH,OAJD;AAKH,KAND,CAME,OAAOL,EAAP,EAAW;AACTV,MAAAA,UAAU,CAACkB,KAAD,EAAOR,EAAP,EAAUK,GAAV,CAAV;AACH;;AACD,WAAOG,KAAP;AACH;;AAED,WAASG,QAAT,CAAkBC,QAAlB,EAA4B;AACxB,SAAKH,SAAL,GAAiBG,QAAjB;AACA,SAAKvB,IAAL,GAAYA,IAAZ;AACH;;AAAA;;AAEDsB,EAAAA,QAAQ,CAACZ,OAAT,GAAmB,UAASG,CAAT,EAAW;AAC1B,WAAOS,QAAQ,CAACzB,UAAT,CAAoBgB,CAApB,IAAyBA,CAAzB,GAA6B;AAACb,MAAAA,IAAI,EAAC,UAASU,OAAT,EAAiB;AAAC,eAAOA,OAAO,CAACG,CAAD,CAAd;AAAkB;AAA1C,KAApC;AACH,GAFD;;AAIAS,EAAAA,QAAQ,CAACzB,UAAT,GAAsBA,UAAtB;AAEA,SAAOyB,QAAP;AACH,CApED","sourcesContent":["module.exports = function() {\n    function isThenable(obj) {\n        return obj && (obj instanceof Object) && typeof obj.then===\"function\";\n    }\n\n    function resolution(p,r,how) {\n        try {\n            /* 2.2.7.1 */\n            var x = how ? how(r):r ;\n\n            if (p===x) /* 2.3.1 */\n                return p.reject(new TypeError(\"Promise resolution loop\")) ;\n\n            if (isThenable(x)) {\n                /* 2.3.3 */\n                x.then(function(y){\n                    resolution(p,y);\n                },function(e){\n                    p.reject(e)\n                }) ;\n            } else {\n                p.resolve(x) ;\n            }\n        } catch (ex) {\n            /* 2.2.7.2 */\n            p.reject(ex) ;\n        }\n    }\n\n    function _unchained(v){}\n    function thenChain(res,rej){\n        this.resolve = res;\n        this.reject = rej;\n    }\n\n    function Chained() {};\n    Chained.prototype = {\n        resolve:_unchained,\n        reject:_unchained,\n        then:thenChain\n    };\n    \n    function then(res,rej){\n        var chain = new Chained() ;\n        try {\n            this._resolver(function(value) {\n                return isThenable(value) ? value.then(res,rej) : resolution(chain,value,res);\n            },function(ex) {\n                resolution(chain,ex,rej) ;\n            }) ;\n        } catch (ex) {\n            resolution(chain,ex,rej);\n        }\n        return chain ;\n    }\n\n    function Thenable(resolver) {\n        this._resolver = resolver ;\n        this.then = then ;\n    };\n\n    Thenable.resolve = function(v){\n        return Thenable.isThenable(v) ? v : {then:function(resolve){return resolve(v)}};\n    };\n\n    Thenable.isThenable = isThenable ;\n\n    return Thenable ;\n} ;\n"]},"metadata":{},"sourceType":"script"}